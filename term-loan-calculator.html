---
layout: default
title: "Term Loan Calculator | Nicolas Lescalier"
---

<style>
  /* ─── Calculator Container ─── */
  .calculator-container {
    max-width: 700px;
    margin: 2rem auto;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    font-family: Arial, sans-serif;
  }

  /* ─── Calculator Header ─── */
  .calculator-header {
    background: #004e89;
    color: #fff;
    padding: 1.5rem 2rem;
    text-align: center;
  }
  .calculator-header h1 {
    margin: 0;
    font-size: 1.75rem;
  }
  .calculator-header p {
    margin: 0.5rem 0 0;
    font-size: 0.95rem;
    opacity: 0.9;
  }

  /* ─── Form Grid ─── */
  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    padding: 2rem;
  }
  .form-group {
    display: flex;
    flex-direction: column;
  }
  .form-group label {
    font-weight: bold;
    margin-bottom: 0.5rem;
    color: #333;
  }
  .input-row {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }
  .input-row input[type="text"],
  .input-row input[type="number"] {
    flex: 1;
    padding: 0.75rem;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    transition: border-color 0.2s;
    text-align: right;
  }
  .input-row input[type="text"]:focus,
  .input-row input[type="number"]:focus {
    outline: none;
    border-color: #004e89;
  }
  .input-row input[type="checkbox"] {
    transform: scale(1.2);
    margin-left: 0.5rem;
  }

  /* ─── Schedule Actions ─── */
  .schedule-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 2rem 1.5rem;
    border-top: 1px solid #eee;
  }
  .schedule-actions .freq label {
    margin-right: 0.5rem;
    font-weight: bold;
    color: #333;
  }
  .schedule-actions .freq select {
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 1rem;
  }
  .btn-download {
    background: #007acc;
    color: #fff;
    border: none;
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.2s;
  }
  .btn-download:hover {
    background: #005fa3;
  }

  /* ─── Table Styles ─── */
  table {
    width: 100%;
    border-collapse: collapse;
    margin: 0 2rem 2rem;
    font-size: 0.95rem;
  }
  th, td {
    padding: 0.75rem;
    border: 1px solid #ddd;
  }
  th {
    background: #004e89;
    color: #fff;
    font-weight: normal;
    text-align: center;
  }
  td {
    text-align: right;
  }
  td:first-child {
    text-align: center;
  }
  tr:nth-child(even) {
    background: #f9f9f9;
  }
</style>

<div class="calculator-container">
  <!-- Header -->
  <div class="calculator-header">
    <h1>Loan Calculator</h1>
    <p>Check the boxes next to the three fields you provide; the calculator will compute the remaining field automatically.</p>
  </div>

  <!-- Form Inputs -->
  <div class="form-grid">
    <div class="form-group">
      <label for="loanAmount">Loan Amount ($)</label>
      <div class="input-row">
        <input
          id="loanAmount"
          type="text"
          value="350,000.00"
          onfocus="this.value=parseFloat(this.value.replace(/,/g,''))||''"
          onblur="this.value=Number(this.value||0).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})"
        />
        <input id="lockAmount" type="checkbox" checked title="Lock this field" />
      </div>
    </div>

    <div class="form-group">
      <label for="interestRate">Interest Rate (%)</label>
      <div class="input-row">
        <input
          id="interestRate"
          type="text"
          value="10.50"
          step="0.01"
          onfocus="this.value=parseFloat(this.value)||''"
          onblur="this.value=Number(this.value||0).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})"
        />
        <input id="lockRate" type="checkbox" checked title="Lock this field" />
      </div>
    </div>

    <div class="form-group">
      <label for="loanTerm">Loan Term (years)</label>
      <div class="input-row">
        <input
          id="loanTerm"
          type="text"
          value="10.00"
          step="0.01"
          onfocus="this.value=parseFloat(this.value)||''"
          onblur="this.value=Number(this.value||0).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})"
        />
        <input id="lockTerm" type="checkbox" checked title="Lock this field" />
      </div>
    </div>

    <div class="form-group">
      <label for="payment">Monthly Payment ($)</label>
      <div class="input-row">
        <input
          id="payment"
          type="text"
          value="4,722.72"
          onfocus="this.value=parseFloat(this.value.replace(/,/g,''))||''"
          onblur="this.value=Number(this.value||0).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})"
        />
        <input id="lockPayment" type="checkbox" title="Lock this field" />
      </div>
    </div>
  </div>

  <!-- Schedule Actions -->
  <div class="schedule-actions">
    <div class="freq">
      <label for="frequency">Amortization Frequency:</label>
      <select id="frequency">
        <option value="monthly">Monthly</option>
        <option value="annual" selected>Annual</option>
      </select>
    </div>
    <button id="download" class="btn-download">Download PDF</button>
  </div>

  <!-- Amortization Schedule Table -->
  <table>
    <thead>
      <tr>
        <th id="hdrPeriod">Year</th>
        <th>Payment</th>
        <th>Principal</th>
        <th>Interest</th>
        <th>Balance</th>
      </tr>
    </thead>
    <tbody id="schedule"></tbody>
  </table>
</div>

<script>
  const $ = id => document.getElementById(id),
        fmt = n => Number(n).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}),
        parseN = str => parseFloat(str.replace(/,/g,'')) || 0;

  function state() {
    const A = parseN($('loanAmount').value),
          R = parseN($('interestRate').value) / 100 / 12,
          Y = parseN($('loanTerm').value),
          N = Math.round(Y * 12),
          P = parseN($('payment').value);

    return {
      A,
      R,
      Y,
      N,
      P,
      freq: $('frequency').value,
      locks: {
        loanAmount:    $('lockAmount').checked,
        interestRate:  $('lockRate').checked,
        loanTerm:      $('lockTerm').checked,
        payment:       $('lockPayment').checked
      }
    };
  }

  function solveMissing(s) {
    const { A, R, N, P, locks } = s;
    if (!locks.payment)
      return A * R / (1 - Math.pow(1 + R, -N));
    if (!locks.loanAmount)
      return P * (1 - Math.pow(1 + R, -N)) / R;
    if (!locks.loanTerm)
      return Math.ceil(
        (-Math.log(1 - (A * R) / P) / Math.log(1 + R)) / 12 * 100
      ) / 100;
    if (!locks.interestRate) {
      let r = 0.01;
      for (let i = 0; i < 20; i++) {
        const f = P * (1 - Math.pow(1 + r, -N)) / r - A;
        const df =
          (-P * (1 - Math.pow(1 + r, -N))) / (r * r) +
          (P * N * Math.pow(1 + r, -N - 1)) / r;
        r -= f / df;
        if (r <= 0) r = Math.abs(r);
      }
      return r * 12 * 100;
    }
    return 0;
  }

  function renderSchedule() {
    const s = state(),
          tbody = $('schedule');
    tbody.innerHTML = '';
    $('hdrPeriod').textContent = s.freq === 'monthly' ? 'Month' : 'Year';

    let bal = s.A;
    if (s.freq === 'monthly') {
      for (let i = 1; i <= s.N; i++) {
        const interest = bal * s.R,
              principal = s.P - interest;
        bal -= principal;

        const tr = tbody.insertRow();
        tr.innerHTML = `
          <td>${i}</td>
          <td>${fmt(s.P)}</td>
          <td>${fmt(principal)}</td>
          <td>${fmt(interest)}</td>
          <td>${fmt(Math.max(bal, 0))}</td>
        `;
      }
    } else {
      let monthsLeft = s.N,
          year = 1;
      while (monthsLeft > 0) {
        let yPay = 0, yPr = 0, yInt = 0,
            count = Math.min(12, monthsLeft);
        for (let j = 0; j < count; j++) {
          const interest = bal * s.R,
                principal = s.P - interest;
          yInt += interest;
          yPr += principal;
          yPay += s.P;
          bal -= principal;
        }
        const tr = tbody.insertRow();
        tr.innerHTML = `
          <td>${year}</td>
          <td>${fmt(yPay)}</td>
          <td>${fmt(yPr)}</td>
          <td>${fmt(yInt)}</td>
          <td>${fmt(Math.max(bal, 0))}</td>
        `;
        monthsLeft -= count;
        year++;
      }
    }
  }

  function calculate() {
    const s = state(),
          missing = Object.keys(s.locks).find(k => !s.locks[k]),
          val = solveMissing(s);
    const map = {
      payment:      'payment',
      loanAmount:   'loanAmount',
      interestRate: 'interestRate',
      loanTerm:     'loanTerm'
    };
    $(map[missing]).value = fmt(val);
    renderSchedule();
  }

  // Download PDF handler
  $('download').onclick = () => {
    calculate();
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({ unit: 'pt', format: 'a4' });
    doc.setFontSize(12);
    doc.text(`Loan Amount: ${$('loanAmount').value}`, 40, 40);
    doc.text(`Interest Rate (%): ${$('interestRate').value}`, 40, 55);
    doc.text(`Loan Term (years): ${$('loanTerm').value}`, 40, 70);
    doc.text(`Payment: ${$('payment').value}`, 40, 85);

    doc.setFontSize(14);
    doc.text('Amortization Schedule', 40, 110);

    const head = [[
      $('hdrPeriod').textContent,
      'Payment',
      'Principal',
      'Interest',
      'Balance'
    ]];
    const body = Array.from($('schedule').rows).map(r => Array.from(r.cells).map(td => td.textContent));

    // @ts-ignore
    doc.autoTable({
      head,
      body,
      startY: 125,
      theme: 'grid'
    });
    doc.save('term-loan-schedule.pdf');
  };

  // Attach real-time validation and calculation
  ['loanAmount','interestRate','loanTerm','lockAmount','lockRate','lockTerm','lockPayment','frequency']
    .forEach(id => $(id).addEventListener('change', calculate));
  ['loanAmount','interestRate','loanTerm','payment']
    .forEach(id => $(id).addEventListener('input', calculate));

  // Initialize on page load
  window.onload = calculate;
</script>
